<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        .font-poppins {
        font-family: 'Poppins', sans-serif;
    }
        .font-inter {
        font-family: 'Inter', sans-serif;
    }
        .font-outfit {
        font-family: 'Outfit', sans-serif;
    }
    #roleDropdown > label::after,
  #roleDropdown.dropdown-open > label::after,
  #roleDropdown:focus-within > label::after {
    content: none !important;
    display: none !important;
  }
  
    </style>

</head>
    <body class="bg-slate-900 min-h-screen flex flex-col items-center py-8">
        <!-- Login Screen -->
<div class="w-full max-w-md p-8 rounded-2xl shadow-lg bg-white/10 backdrop-blur-lg border border-white/20">
    <h1 class="text-3xl font-bold text-center font-poppins text-white mb-6">Login</h1>

    <!-- Role Selector -->
    <div class="form-control w-full">
  <label class="label">
    <span class="label-text text-lg font-outfit">Login as</span>
  </label>
  <div id="roleDropdown" class="dropdown w-full">
    <label id="roleButton" tabindex="0" class="btn btn-outline w-full rounded-full justify-between font-outfit">
      <span id="selectedRoleText"> Select Role</span>
      <svg id="dropdownIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </label>
    <ul tabindex="0" class="dropdown-content menu p-2 shadow bg-base-100 rounded-2xl w-full mt-1 font-outfit transition-all duration-200 ease-in-out">
      <li><a data-role="Admin">Admin</a></li>
      <li><a data-role="User">User</a></li>
    </ul>
  </div>
</div>


    <!-- Email -->
    <div class="mb-4 mt-4">
      <label for="email" class="block text-lg text-white mb-1 font-outfit">Email</label>
      <input id="email" type="email" placeholder="Enter email" class="w-full p-3 rounded-full bg-white/20 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 font-outfit">
    </div>

    <!-- Password -->
    <div class="mb-6">
      <label for="password" class="block text-lg text-white mb-1 font-outfit">Password</label>
      <input id="password" type="password" placeholder="Enter password" class="w-full p-3 rounded-full bg-white/20 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 font-outfit">
    </div>

    <!-- Login Button -->
    <button id="loginBtn" class="w-full text-lg py-3 bg-red-500 hover:bg-red-900 rounded-full text-white font-semibold transition duration-200 font-outfit">Login</button>
  </div>

    <div id="splash" class="fixed inset-0 flex items-center justify-center bg-gray-900 text-white text-4xl font-bold z-50">
    <h1 id="welcomeText" class="text-4xl font-bold text-white font-inter">Welcome Swapnil</h1>
    </div>
    <div id="dashboard" class="flex flex-col items-center w-full max-w-6xl px-4 hidden">
        <!-- Page Title -->
    <h1 class="text-3xl font-bold mb-8 font-poppins">User Dashboard</h1>

    <!-- Add User Button -->
    <button id="addUserBtn" class="btn btn-primary mb-6 font-inter">Add User</button>

    <!-- Add User Form (Hidden Initially) -->
    <form id="userForm" class="card w-full max-w-md bg-base-100 shadow-xl p-6 hidden">
        <div class="form-control mb-4">
        <label class="label">
            <span class="label-text font-poppins">Full Name</span>
        </label>
        <input type="text" id="fullName" class="input input-bordered font-poppins" required>
        </div>

        <div class="form-control mb-6">
        <label class="label">
            <span class="label-text font-poppins">Job Title</span>
        </label>
        <input type="text" id="jobTitle" class="input input-bordered font-poppins" required>
        </div>

        <div class="flex justify-end gap-3">
        <button type="button" id="cancelBtn" class="btn btn-outline font-poppins">Cancel</button>
        <button type="submit" class="btn btn-success font-poppins">Save</button>
        </div>
    </form>

    <!-- User Cards Container -->
    <div id="userCards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-8 w-full max-w-6xl font-poppins">
        <!-- Cards will be added here by JS -->
    </div>
    </div>
 <script src="https://cdn.tailwindcss.com"></script>  
 <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>

 <script>
    
    document.addEventListener("DOMContentLoaded", () => {
  // ===== DOM =====
  const splash = document.getElementById("splash");
  const dashboard = document.getElementById("dashboard");
  const roleDropdown = document.getElementById("roleDropdown");
  const selectedRole = document.getElementById("selectedRoleText");
  const roleOptions = roleDropdown.querySelectorAll("ul li a");
  const loginBtn = document.getElementById("loginBtn");
  const emailInput = document.getElementById("email");
  const passwordInput = document.getElementById("password");

  const addUserBtn = document.getElementById("addUserBtn");
  const userForm = document.getElementById("userForm");
  const fullName = document.getElementById("fullName");
  const jobTitle = document.getElementById("jobTitle");
  const cancelBtn = document.getElementById("cancelBtn");
  const userCards = document.getElementById("userCards");
  

  // Avoid flicker
  splash.style.display = "none";
  dashboard.style.display = "none";
  dashboard.style.opacity = "0";

  // ===== STATE =====
  let formMode = "add";
  let cardBeingEdited = null;
  let editUserId = null;
  let authToken = null;
  let currentRole = null;

  // Reqres free tier needs this header everywhere
  const apiHeaders = {
    "x-api-key": "reqres-free-v1",
    "Content-Type": "application/json"
  };

  const sampleJobs = [
    "Programmer","Sales","Marketing","UI/UX Designer","Data Analyst","Product Manager"
  ];

  roleOptions.forEach(option => {
  option.addEventListener("click", (e) => {
    e.preventDefault();

    selectedRole.innerHTML = `${e.target.textContent} 
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>`;

    currentRole = e.target.textContent;
    console.log("Selected Role:", currentRole);
  });
});



roleDropdown.querySelectorAll('ul li a').forEach(a =>{
    a.addEventListener('click',(e)=>{
      e.preventDefault();
      currentRole = a.dataset.role || a.textContent.trim();
      selectedRoleText.textContent = currentRole;
      document.activeElement.blur();
    })
  })


  loginBtn.addEventListener("click",async()=>{
    const email = emailInput.value.trim();
    const password = passwordInput.value.trim();
    if (!email || !password){
      alert("Please enter email and password!");
      return;
    }
    if (!currentRole){
      alert("Please select a role");
      return;
    }
    try {
      const res = await fetch("https://reqres.in/api/login",{
        method: "POST",
        headers: apiHeaders,
        body: JSON.stringify({email,password})
      });
      if (!res.ok) throw new Error("Invalid Credentials");
      const data = await res.json();
      authToken = data.token;
      console.log("Login Successful, token =",authToken);

      if (currentRole === "Admin" && email!== "eve.holt@reqres.in"){
        alert("This email is not valid for Admin role");
        return;
      }
      if(currentRole === "User" && email !== "george.bluth@reqres.in"){
        alert("This email is not valid for User role");
        return;
      }

      document.querySelector("body>div").style.display = "none";
      splash.style.display = "flex";

      anime({
    targets: splash,
    opacity: [0, 1],
    scale: [0.5, 1],
    duration: 1000,
    easing: "easeOutExpo"
  });
  setTimeout(async() => {
    anime({
      targets: splash,
      opacity: [1, 0],
      duration: 800,
      easing: "easeInOutQuad",
      complete: async () => {
        splash.style.display = "none";
        await loadExistingUsers();

        // Show dashboard smoothly
        dashboard.style.display = "block";
        anime({
          targets: dashboard,
          opacity: [0, 1],
          duration: 800,
          easing: "easeOutQuad"
        });
      }
    });
  }, 2000);
    } catch (err){
      alert("Login failed: " + err.message);
    }
  });

  // ===== GET: list users =====
  async function loadExistingUsers() {
    try {
      const res = await fetch("https://reqres.in/api/users?page=1", {
        headers: { "x-api-key": "reqres-free-v1" }
      });
      if (!res.ok) throw new Error(`HTTP Error! status: ${res.status}`);
      const data = await res.json();

      data.data.forEach((u) => {
        const randomJob = sampleJobs[Math.floor(Math.random() * sampleJobs.length)];
        createUserCard(u.id, `${u.first_name} ${u.last_name}`, randomJob);
      });
    } catch (err) {
      console.error("Error loading users:", err);
    }
  }

  // ===== Splash â†’ Dashboard (Anime.js) =====
  

  

  // ===== UI handlers =====
  addUserBtn.addEventListener("click", () => {
    formMode = "add";
    userForm.reset();
    userForm.classList.remove("hidden");
    addUserBtn.classList.add("hidden");
  });

  cancelBtn.addEventListener("click", () => {
    userForm.classList.add("hidden");
    addUserBtn.classList.remove("hidden");
    cardBeingEdited = null;
  });

  userForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const name = fullName.value.trim();
    const job = jobTitle.value.trim();
    if (!name || !job) return;

    if (formMode === "add") {
      await addUser(name, job);
    } else {
      await updateUser(editUserId, name, job);
    }
  });

  // ===== POST: create user =====
  async function addUser(name, job) {
    try {
      const res = await fetch("https://reqres.in/api/users", {
        method: "POST",
        headers: apiHeaders,
        body: JSON.stringify({ name, job })
      });
      if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
      const data = await res.json();

      createUserCard(data.id || Date.now(), data.name || name, data.job || job);
      userForm.reset();
      userForm.classList.add("hidden");
      addUserBtn.classList.remove("hidden");
    } catch (err) {
      console.error("Error creating user:", err);
    }
  }

  // ===== PUT: update user =====
  async function updateUser(id, name, job) {
    try {
      const res = await fetch(`https://reqres.in/api/users/${id}`, {
        method: "PUT",
        headers: apiHeaders,
        body: JSON.stringify({ name, job })
      });
      if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
      const updated = await res.json();

      if (cardBeingEdited) {
        cardBeingEdited.querySelector(".card-title").textContent = updated.name || name;
        cardBeingEdited.querySelector("p").textContent = updated.job || job;
      }

      userForm.reset();
      userForm.classList.add("hidden");
      addUserBtn.classList.remove("hidden");
      cardBeingEdited = null;
    } catch (err) {
      console.error("Error updating user:", err);
    }
  }

  // ===== Card factory =====
  function createUserCard(id, name, job) {
    const card = document.createElement("div");
    card.className = "card bg-base-100 shadow-xl p-4";
    card.innerHTML = `
      <div class="card-body">
        <h2 class="card-title">${name}</h2>
        <p>${job}</p>
        <div class="card-actions justify-end">
          <button class="btn btn-outline btn-sm details-btn">Details</button>
          <button class="btn btn-outline btn-sm edit-btn">Edit</button>
          <button class="btn btn-error btn-sm delete-btn">Delete</button>
        </div>
      </div>`;

    // GET single (Details) â€” include x-api-key
    card.querySelector(".details-btn").addEventListener("click", async () => {
      try {
        const res = await fetch(`https://reqres.in/api/users/${id}`, {
          headers: { "x-api-key": "reqres-free-v1" }
        });
        if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
        const data = await res.json();
        alert(`User Details:\nName: ${data.data.first_name} ${data.data.last_name}\nEmail: ${data.data.email}`);
      } catch (err) {
        console.error("Error fetching single user:", err);
      }
    });

    // Edit
    card.querySelector(".edit-btn").addEventListener("click", () => {
      formMode = "edit";
      editUserId = id;
      cardBeingEdited = card;
      fullName.value = name;
      jobTitle.value = job;
      userForm.classList.remove("hidden");
      addUserBtn.classList.add("hidden");
    });

    // DELETE
    card.querySelector(".delete-btn").addEventListener("click", async () => {
      try {
        const res = await fetch(`https://reqres.in/api/users/${id}`, {
          method: "DELETE",
          headers: { "x-api-key": "reqres-free-v1" }
        });
        if (res.ok) {
          anime({
            targets: card,
            opacity: [1, 0],
            scale: [1, 0.8],
            easing: "easeInExpo",
            duration: 500,
            complete: () => card.remove()
          });
        } else {
          console.error(`Failed to delete user with id ${id}`);
        }
      } catch (err) {
        console.error("Error deleting user:", err);
      }
    });

    // Enter animation
    userCards.appendChild(card);
    card.style.opacity = "0";
    card.style.transform = "translateY(50px)";
    anime({
      targets: card,
      opacity: [0, 1],
      translateY: [50, 0],
      easing: "easeOutExpo",
      duration: 700
    });
  }
});




 </script> 
</body>
</html>